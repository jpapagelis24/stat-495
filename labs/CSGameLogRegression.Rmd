---
title: "Stat 495 - Logistic Regression Practice - CS Game"
author: "A.S. Wagaman"
output:
  pdf_document:
    fig_height: 3
    fig_width: 5
  html_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5
---

## Stat 495 - CS Game 

```{r, include = FALSE}
library(mosaic)
library(readr)
library(broom)
library(mosaic)
library(Stat2Data)
library(lmtest)
library("DescTools")
```


```{r}
csgame <- read.csv("https://awagaman.people.amherst.edu/stat495/csgame.csv", header = T)
```

A student at Amherst has written a portion of a video game while studying the behavior of some computer algorithms. For a particular encounter in the video game, ten different inputs are used to determine the outcome of the encounter - i.e. whether the player wins or loses a fight against a monster. A set of 190 test instances of the encounter have had their inputs recorded, as well as the outcome. The data set is available as csgame.csv. 

The inputs are: BaseAttack, BaseDefense, Charisma, Constitution, Dexterity, Intelligence, MagicDefense, MonsterAttack, MonsterMagic, and ZoneLevel. The first 7 inputs are player attributes and higher values denote a stronger player character. You should note that BaseDefense is based on armor, and MagicDefense is not, and also that it is usually the case that characters in plate armor (the strongest usually available in these sorts of games) are usually not strong magic users, and vice versa (magic users often wear cloth armor, generally the weakest available). The 8th and 9th input variables are monster attributes where higher values indicate a stronger, more powerful monster. Finally, ZoneLevel is an indication of how hard the zone where the encounter takes place is (higher values should be a harder zone). Some of the input names are based on concepts from Dungeons and Dragons.

The outcome variable is provided both numerically as 0 and 1 and categorically as Loss and Win (Loss=0; Win=1) in the variables OutcomeNum and Outcome, respectively. 

Another student wants to play the game and win the encounter, and is looking for guidance as to how to approach that. For example, should they develop a character with high Dexterity or one with high Charisma if they want to win the encounter?

Your task is to examine the data set and perform a relevant analysis to assist the students (predict the outcome using the input variables).  Provide relevant interpretations of your findings for the student who wants to win the encounter as well as for the student who has written the game. 

### Analysis

```{r}
glimpse(csgame)
```

```{r}
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = BaseAttack)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = Charisma)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = MonsterMagic)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = Dexterity)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = Intelligence)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = Constitution)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = MonsterAttack)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = BaseDefense)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = ZoneLevel)) + geom_boxplot() + labs(x = "Outcome Num")
ggplot(csgame, aes(x = as.factor(OutcomeNum), y = MagicDefense)) + geom_boxplot() + labs(x = "Outcome Num")
```


```{r}
# Add log Price
csgame <- mutate(csgame, logBaseDefense = log(BaseDefense))
csgame <- mutate(csgame, logMagicDefense = log(MagicDefense))
#Fit model and get basic output
logm <- glm(OutcomeNum ~ logBaseDefense + logMagicDefense,
            data = csgame, family = binomial(logit))
msummary(logm)
```

```{r}
lrtest(logm)
```
```{r}
exp(confint(logm))
```
```{r}
logmaugment <- logm %>% augment(type.predict = "response")
names(logmaugment)
```

```{r}
logmaugment <- mutate(logmaugment, binprediction = round(.fitted, 0))
tally(~ binprediction, data = logmaugment)

tally(~ OutcomeNum, data = csgame)
```


